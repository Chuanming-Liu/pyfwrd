44c44
<       character*80 name,title,name_model
---
>       character*80 name,title
109,118c109
<       print *,'enter velocity model for modelling'
<       print *,'leading space = <animodel>'
<       read(5,102) name_model
<       print *,'enter sampling time e.g., 0.05 for 20 sps'
<       read(5,*) dt
<       if(name_model(1:1).eq.' ') then
<         open(7,file='animodel',form='formatted')
<       else
<         open(7,file=name_model,form='formatted')
<       endif
---
>       open(7,file='animodel',form='formatted')
617c608
<       name='/Users/jjpark/Research/Layers/test.bhz'
---
>       name='/Users/jjpark/Courses/GEO557/T05C.BHZ'
963d953
<       dimension jp(3)
965,968d954
< c  jp() permutes the R and T components in one LU decomposition to avoid crash
<       jp(1)=1
<       jp(2)=3
<       jp(3)=2
1437d1422
< c	print *,'zzget one'
1470,1471d1454
< c  use the permutation jp to switch the R and T components, to avoid a zero-pivot 
< c  in subroutine csolve whenever R and T are do not couple (e.g. isotropic media)
1475,1476c1458,1459
<           s(jp(i),jp(k))=dreal(ee(i+3,k,1))
<           t(jp(i),jp(k))=dimag(ee(i+3,k,1))
---
>           s(i,k)=dreal(ee(i+3,k,1))
>           t(i,k)=dimag(ee(i+3,k,1))
1490,1494d1472
< c      print *,'zzget two ',idfct(3,1)
< c      do k=1,3
< c        print 1111,(s(i,k),t(i,k),i=1,3)
< c      end do
<  1111 format(3(2e13.4,3x))
1497,1498c1475,1476
<           yr(jp(i))=dreal(rt0(i,k))
<           yi(jp(i))=dimag(rt0(i,k))
---
>           yr(i)=dreal(rt0(i,k))
>           yi(i)=dimag(rt0(i,k))
1503c1481
<           rt0(i,k)=-dcmplx(xr(jp(i)),xi(jp(i)))
---
>           rt0(i,k)=-dcmplx(xr(i),xi(i))
1675d1652
< c      print *,'in defective'
2342,2343c2319,2320
<   400 print 101,aam,i,n                                                           
<   101 format('near-zero pivot in lup ',e12.5,'  on column',i3,' of',i3)                         
---
>   400 print 101,aam,i                                                           
>   101 format('near-zero pivot ',e12.5,'  on column',i3)                         
2426,2427c2403,2404
<   400 print 101,aam,i,n
<   101 format('near-zero pivot in clup ',e12.5,'  on column',i3,' of',i3)                         
---
>   400 print 101,aam,i                                                           
>   101 format('near-zero pivot ',e12.5,'  on column',i3)                         
